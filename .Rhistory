)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'crosshatch', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
annotate('dots represent insignificant effects (5%)', x = 50, y -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
annotate('dots represent insignificant effects (5%)', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
annotate(geom = 'dots represent insignificant effects (5%)', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
annotate(geom = 'text', label = 'dots represent insignificant effects (5%)', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = ''
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1, vjust = 1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.title.align=0.5,
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=1),
legend.title.align=0.5,
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0),
legend.title.align=0.5,
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
)
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(colour = guide_legend(title.position = "right"))
map_effects
ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(colour = guide_legend(title.position = "right"))
# 0.2. load packages
requiredPackages <- c('tidyverse', 'haven', 'readxl', 'utf8', 'rjson', 'osmdata', 'sf', 'sp', 'broom', 'viridis', 'cowplot', 'reshape2', 'spatialreg',
'spdep', 'plm', 'splm', 'Metrics', 'stargazer', 'kableExtra', 'ggpattern', 'scales')
for (i in requiredPackages) {
if (!require(i,character.only = T)) {
install.packages(i, character.only = T)
}
}
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(colour = guide_legend(title.position = "right"))
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(fill = guide_legend(title.position = "right"))
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(fill = guide_legend(title.position = "bottom"))
map_effects
map_effects <- ggplot() +
geom_polygon_pattern(data = locs_sp[locs_sp$effect_significant == 'F', ], aes(x=long, y=lat, group=group, fill=effect_bin), pattern = 'magick', colour='black', size=0.5, alpha=0.9) +
geom_polygon(data = locs_sp[locs_sp$effect_significant == 'T', ], aes(x=long, y=lat, group=group, fill=effect_bin), colour='black', size=0.5, alpha=0.9) +
coord_sf() +
scale_fill_viridis(discrete=T) +
#annotate(geom = 'text', label = '', x = 50, y = -2) +
labs(
caption = 'Data Source: own calculation',
title = 'Individual Effects',
fill = 'dots represent insignificant effects (5%)'
) +
theme_void() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
plot.background = element_blank(),
plot.title = element_text(color="#000000", face="bold", size=16, hjust=0.5),
plot.caption = element_text(color="#000000", face="bold", size=10, hjust=1),
plot.margin = unit(c(0.5,0.5,0.5,0.5), "cm"),
strip.text.x = element_text(color="#505050", face="bold", size=12, hjust=0.5),
legend.title = element_text(color="#505050", size=12, hjust=0.5),
legend.text = element_text(color="#505050", size=10, angle = 0),
legend.position = 'bottom'
) +
guides(fill = guide_legend(title.position = "bottom"))
map_effects
png('img/map_effects.png', width = 3508, height = 2480, res=300)
map_effects
dev.off()
map_effects
png('img/map_effects.png', width = 3508, height = 2480, res=300)
map_effects
dev.off()
